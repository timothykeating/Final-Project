CREATE TABLE variantdata (
location VARCHAR (255) NOT NULL,
date DATE NOT NULL,
variant VARCHAR (255) NOT NULL,
num_sequences INTEGER NOT NULL,
perc_sequences DOUBLE PRECISION NOT NULL,
num_sequences_total INTEGER NOT NULL
);

select * from countries

select distinct location from stage_variantdata


SELECT *
FROM stage_variantdata
WHERE variant in ('Alpha','Delta','Omicron')

select max(date) from stage_variantdata

select location, sum(num_sequences) as "TOTAL CASES"
from variantdata
WHERE variant in ('Alpha','Delta','Omicron')
group by location
order by 2 desc

ALTER TABLE variantdata
RENAME TO stage_variantdata;

CREATE TABLE step2_variantdata (
Country VARCHAR (255) NOT NULL,
Date DATE NOT NULL,
Variant VARCHAR (255) NOT NULL,
variantInfections INTEGER NOT NULL,
variantPercentOfDailyTotal DOUBLE PRECISION NOT NULL,
totalDailyInfections INTEGER NOT NULL
);

CREATE TABLE countries (
country_name VARCHAR (255) NOT NULL,
country_code VARCHAR (255) NOT NULL,
population INTEGER NOT NULL
);

select * from countries